<!DOCTYPE html>
<html>
<head>
    <title>Check stuff with Kiva oAuth</title>
    <link rel="stylesheet" href="/lib/jquery-ui/css/start/jquery-ui-1.10.0.custom.min.css" />
    <link rel="stylesheet" href="/css/bootstrap.min.css" media="screen">
    <script src="/js/handlebars.js"></script>
    <style type="text/css">
		#mydiv {
		    position:fixed;
		    top: 50%;
		    left: 50%;
		    width:30em;
		    height:18em;
		    margin-top: -9em; /*set to a negative number 1/2 of your height*/
		    margin-left: -15em; /*set to a negative number 1/2 of your width*/
		}
    </style>
    <script type="text/javascript">
    	function showWelcomeMessage(){
            $.ajax({
              url: "/welcome",
              processData: false,
              contentType: "application/json",
              method:"GET",
              success:function(data) {
              	console.log(data);
              	$('#welcome-message').html("Welcome to Kiva-oAuth Demo <br>" + data.message);
              },
              error:function(error) {
              	console.log(error);
              }
            });         
    	}
    	function checkBalance(){
            $.ajax({
              url: "/balance",
              processData: false,
              contentType: "application/json",
              method:"GET",
              success:function(data) {
              	$('#kiva_balance').text(JSON.parse(data).user_balance.balance);
              	$('#balancemodal').modal('show');

              },
              error:function(error) {
                console.log(error);
              }
            });         
    	}
    </script>
</head>
<body>
	<div class="container-fluid">
		<div class="hero-unit">
			<div id="welcome-message" ></div>
			<form action="/logout">
				<button type="submit">Logout</button>
			</form>
			
		</div>
	    <div class="row-fluid">
	        <div class="span5">
	        </div>
	        <div id="mydiv" class="span2">
			   <button class="btn btn-large btn-primary" style="width:100%;height:100%" type="button" onclick="checkBalance();">Check Kiva Balance</button>
	        </div>
	        <div class="span5">
	        </div>
	    </div>
		<div id="balancemodal" class="modal hide fade">
		  <div class="modal-header">
		    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
		    <h3>Kiva Balance</h3>
		  </div>
		  <div class="modal-body">
		    <p>Your current Kiva balance is $<span id="kiva_balance"></span></p>
		  </div>
		  <div class="modal-footer">
		    <a href="#" class="btn" onclick="$('#balancemodal').modal('hide');">Close</a>
		  </div>
		</div>	    
	</div>
	<script src="/lib/jquery-ui/js/jquery-1.9.0.js"></script>
	<script src="/js/bootstrap.min.js"></script>
	<script src="/lib/jquery-ui/js/jquery-ui-1.10.0.custom.min.js"></script>
	<script type="text/javascript">
		document.addEventListener("DOMContentLoaded", showWelcomeMessage());
	</script>
	
</body>
</html>